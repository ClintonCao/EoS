from collections import Counter

DATE = 0
DOMAIN = 1
IP = 2
REVERSE_LOOKUP = 3
DESCRIPTION = 4
REGISTRANT = 5
ASN = 6
COUNTRY = 7

ATTRIBUTES = {0: 'date',
              1: 'domain',
              2: 'ip',
              3: 'reverse lookup',
              4: 'description',
              5: 'registrant',
              6: 'asn',
              7: 'country'}

malware_domains = None
with open('export.csv') as f:
    malware_domains = f.read().split('\n')

for i, domain in enumerate(malware_domains):
    malware_domains[i] = malware_domains[i].replace('"', '').split(',')


def get_attribute_from_domain(domain, attribute):
    try:
        return domain[attribute]
    except:
        return ''


def get_attribute_values(attribute):
    values = []
    for domain in malware_domains:
        values.append(get_attribute_from_domain(domain, attribute))
    return values

if __name__ == '__main__':
    print 'There are %d entries' % len(malware_domains)

    unique_sets = {}
    lists = {}

    for domain in malware_domains:
        for attribute in range(8):
            value = get_attribute_from_domain(domain, attribute)
            if value in ('', '-'):
                continue
            attribute_set = unique_sets.setdefault(attribute, set())
            attribute_set.add(value)
            attribute_list = lists.setdefault(attribute, list())
            attribute_list.append(value)

    for i in range(8):
        name = ATTRIBUTES[i]
        print '%d unique %s(s)' % (len(unique_sets[i]), name)
        c = Counter(lists[i])
        print 'Top 5 %s: %s' % (name, sorted(c.items(), key=lambda x: -x[1])[:5])
